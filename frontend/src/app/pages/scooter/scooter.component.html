<header class="header">
    <app-back-button path="{{ backButtonPath }}"></app-back-button>
    <div class="productName">
      <h1>{{ scooter?.product_id }}</h1>
    </div>
</header>

<div class="scrollable-container">
    <ng-container *ngIf="!loadingScooter; else loading">
        <ng-container *ngIf="!scooterNotFound; else noScooters">
            <div class="white-box" style="display: flex;">
                <!-- <img *ngIf="product" class="picture" src="http://localhost:8000/img/products/{{ product.name }}.jpg"> -->
                <img *ngIf="product" class="picture" [src]="getImageUrl(product.name)">
                <div class="information-block" *ngIf="scooter !== null && product !== null">

                  <div class="status-circles-container">
                    <div class="container">
                        <div class="circle">
                            <!-- <div class="outer" [style.--battery]="roundUpBattery(scooter.battery) + '%'"> -->
                            <div class="outer" [style.--battery]="batteryStatus + '%'">
                                <div class="inner">
                                    <div id="inside-circle-battery">
                                        {{ roundUpBattery(scooter.battery) }}%
                                    </div>
                                </div>
                            </div>
                        </div>
                      <p class="secondary-text">Batteriestand</p>
                    </div>
                    <div class="container">
                        <div class="circle">
                            <!-- <div class="outer" [style.--battery]="calcRange(scooter.battery, product.max_reach) + '%'"> -->
                            <div class="outer" [style.--battery]="rangeStatus + '%'">
                                <div class="inner">
                                    <div id="inside-circle-reach">
                                        {{ convertDistanceUnits(calcRange(scooter.battery, product.max_reach), selectedDistance) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p class="secondary-text">Reichweite</p>
                    </div>
                    <div class="container">
                        <div class="circle">
                            <!-- <div class="outer" [style.--battery]="product.max_speed + '%'"> -->
                            <div class="outer" [style.--battery]="speedStatus + '%'">
                                <div class="inner">
                                    <div id="inside-circle-reach">
                                        {{ convertSpeedUnits(product.max_speed, selectedSpeed) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p class="secondary-text">Geschwindigkeit</p>
                    </div>
                  </div>
                    
                    <div class="price" style="display: flex;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
                            <path d="M19.6242 10.4613L11.53 2.36712C11.1908 2.02795 10.7233 1.83545 10.2375 1.83545H3.665C2.65667 1.83545 1.83167 2.66045 1.83167 3.66878V10.2413C1.83167 10.7271 2.02416 11.1946 2.3725 11.5338L10.4667 19.628C11.1817 20.343 12.3458 20.343 13.0608 19.628L19.6333 13.0555C20.3483 12.3405 20.3483 11.1854 19.6242 10.4613ZM11.7592 18.3355L3.665 10.2413V3.66878H10.2375L18.3317 11.7629L11.7592 18.3355Z" fill="#97FB64"/>
                            <path d="M5.95667 7.33545C6.71606 7.33545 7.33167 6.71984 7.33167 5.96045C7.33167 5.20106 6.71606 4.58545 5.95667 4.58545C5.19727 4.58545 4.58167 5.20106 4.58167 5.96045C4.58167 6.71984 5.19727 7.33545 5.95667 7.33545Z" fill="#97FB64"/>
                        </svg>
                        <div class="price-text">{{ convertCurrencyUnits(product.price_per_hour, selectedCurrency) }}</div>
                    </div>
                </div>
            </div>

            <div class="bottom">
                <app-button color="primary" type="submit" class="scooterBook-btn" (click)="onBook()" [disabled]="!canRent">
                    Scooter buchen
                </app-button>
                <ng-container *ngIf="!canCancel">
                    <app-button color="primary" type="submit" class="scooterBook-btn" (click)="onReserve()" [disabled]="!canRent || !canReserve">
                        Scooter reservieren
                    </app-button>
                </ng-container>
                <ng-container *ngIf="canCancel">
                    <app-button color="warn" type="submit" class="scooterBook-btn" (click)="onEndReservation()">
                        Reservierung beenden
                    </app-button>
                </ng-container>
            </div>

            <div style="padding: 15px;">
                <hr class="solid">
                <div class="description" innerHTML="{{ product?.description_html }}">Beschreibung</div>
                <hr class="solid">
                <h2 style="margin: 15px;">Standort</h2>
                <div class="map" leaflet [leafletOptions]="options" [(leafletCenter)]="center" [leafletLayers]="layers"></div>
            </div>
        </ng-container>
    </ng-container>

    <ng-template #noScooters>
        <div class="no-scooter-container">
            <h3>Scooter nicht gefunden.</h3>
            <img class="noScooterpicture" src="/assets/NoScooter.png" />
        </div>
    </ng-template>

    <ng-template #loading>
      <app-loading-overlay [isLoading]="true" type="inline"></app-loading-overlay>
    </ng-template>
</div>